<nz-page-header nzBackIcon nzTitle="Mi Carrito"></nz-page-header>
<nz-steps [nzCurrent]="current">
    <nz-step nzTitle="Acceso" [nzDescription]="(user$ | async)?.email"></nz-step>
    <nz-step nzTitle="Confirmar">
    </nz-step>
    <nz-step nzTitle="Pagar"></nz-step>
</nz-steps>
<div class="steps-content">
    <div nz-row *ngIf="current === 1">
        <div nz-col nzFlex="3" class="ph-1">
            <app-cart-list [products]="products$" (onChangeQty)="onChangeQuantity($event)"
                (remove)="handleRemoveProduct($event)"></app-cart-list>
        </div>
        <div nz-col nzFlex="1" class="ph-1">
            <app-cart-summary [cartSummary]="cartSummary" [isSaving]="isSaving" (finish)="handleFinish()">
            </app-cart-summary>
        </div>
    </div>
    <div *ngIf="current == 2" class="payment">
        <nz-card>
            <nz-statistic [nzValue]="(cartSummary.total | number)!" [nzPrefix]="'$'" [nzTitle]="'Total a pagar'"
                [nzValueStyle]="{color: '#47a359'}">
            </nz-statistic>
            <nz-divider></nz-divider>
            <nz-statistic [nzValue]="(user$ | async)?.email" [nzTitle]="'Cliente'"></nz-statistic>
            <nz-statistic [nzValue]="cart?.id" [nzTitle]="'Orden nÃºmero'"></nz-statistic>
            <nz-divider></nz-divider>
            <div nz-row>
                <div nz-col nzSpan="12" style="text-align:left">
                    <a nz-button nzType="link" (click)="handleBack()">Regresar</a>
                </div>
                <div nz-col nzSpan="12">
                    <button nz-button nzType="primary" nzBlock (click)="handlePay()" [nzLoading]="isSaving"
                        [disabled]="isSaving">Pagar</button>
                </div>
            </div>
        </nz-card>
    </div>
    <div *ngIf="current == 3" class="payment">
        <nz-card>
            <nz-result nzStatus="success" nzTitle="Orden completada!" nzSubTitle="Gracias por tu compra">
                <div nz-result-extra>
                    <a nz-button [routerLink]="['/welcome']">Continuar</a>
                </div>
            </nz-result>
        </nz-card>
    </div>
</div>